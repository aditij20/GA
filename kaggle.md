Linear Regression and Cross Validation: Kaggle Salary Competition
========================================================

This is an R Markdown document. Markdown is a simple formatting syntax for authoring web pages (click the **MD** toolbar button for help on Markdown).

When you click the **Knit HTML** button a web page will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:


```r
#
# 
# Variables: Id, Title - job description, often including location
# FullDescription - detailed job description LocationRaw -
# LocationNormalized - city ContractType - full_time, part_time, NA
# (almost always full-time according to boxplots) ContractTime -
# permanent, contract, NULL (boxplots very different) Company - recruiting
# company or actual?  Category - job category, e.g. engineering **
# SalaryRaw - salary, often as range (pounds) SalaryNormalized - salaray
# as actual number (pounds) SourceName - URL (of job posting?)

require("plyr")
```

```
## Loading required package: plyr
```

```r
require("DAAG")
```

```
## Loading required package: DAAG
```

```
## Loading required package: MASS
```

```
## Loading required package: lattice
```

```
## Loading required package: latticeExtra
```

```
## Loading required package: RColorBrewer
```

```
## Loading required package: rpart
```

```
## Loading required package: randomForest
```

```
## randomForest 4.6-7
```

```
## Type rfNews() to see new features/changes/bug fixes.
```

```
## Loading required package: boot
```

```
## Attaching package: 'boot'
```

```
## The following object(s) are masked from 'package:lattice':
## 
## melanoma
```

```
## Loading required package: survival
```

```
## Loading required package: splines
```

```
## Attaching package: 'survival'
```

```
## The following object(s) are masked from 'package:boot':
## 
## aml
```

```
## Attaching package: 'DAAG'
```

```
## The following object(s) are masked from 'package:survival':
## 
## lung
```

```
## The following object(s) are masked from 'package:MASS':
## 
## hills
```

```
## The following object(s) are masked from 'package:plyr':
## 
## ozone
```

```r

setwd("/Volumes/DATA/robert/Desktop/Projects/GA/salary")

df <- read.csv("data/train.csv")
test <- read.csv("data/test.csv")


# Rename some columns to make life easier
df2 <- df

df2 <- rename(df2, replace = c(LocationNormalized = "City"))
df2 <- rename(df2, c(SalaryNormalized = "Salary"))
test <- rename(test, c(LocationNormalized = "City"), warn_missing = TRUE)


# Remove *** and city from description
df2$city <- as.numeric(as.factor(df2$City))
df2$category <- as.numeric(as.factor(df2$Category))
df2$ctime <- as.numeric(as.factor(df2$ContractTime))
df2$ctype <- as.numeric(as.factor(df2$ContractType))
df2$company <- as.numeric(as.factor(df2$Company))


test$city <- as.numeric(as.factor(test$City))
test$category <- as.numeric(as.factor(test$Category))
test$ctime <- as.numeric(as.factor(test$ContractTime))
test$ctype <- as.numeric(as.factor(test$ContractType))
test$company <- as.numeric(as.factor(test$Company))



# Code the categories

salary.glm <- glm(Salary ~ city + category + ctime + ctype + company, data = df2)
summary(salary.glm)
```

```
## 
## Call:
## glm(formula = Salary ~ city + category + ctime + ctype + company, 
##     data = df2)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -29109  -10109   -3829    6038  137961  
## 
## Coefficients:
##              Estimate Std. Error t value Pr(>|t|)    
## (Intercept) 28335.886    642.377   44.11  < 2e-16 ***
## city            1.241      0.601    2.07    0.039 *  
## category     -169.583     26.303   -6.45  1.2e-10 ***
## ctime        4631.938    169.310   27.36  < 2e-16 ***
## ctype       -1482.168    261.217   -5.67  1.4e-08 ***
## company        -5.617      0.426  -13.18  < 2e-16 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## (Dispersion parameter for gaussian family taken to be 241149598)
## 
##     Null deviance: 2.609e+12  on 9999  degrees of freedom
## Residual deviance: 2.410e+12  on 9994  degrees of freedom
## AIC: 221396
## 
## Number of Fisher Scoring iterations: 2
```

```r

plot(predict(salary.lm, test))
```

```
## Error: object 'salary.lm' not found
```

```r

cv.glm(df2, salary.glm, K = 10)
```

```
## $call
## cv.glm(data = df2, glmfit = salary.glm, K = 10)
## 
## $K
## [1] 10
## 
## $delta
## [1] 241381563 241361732
## 
## $seed
##   [1]         403           1    21114519 -1122621442  1618523064
##   [6]    86454171  -689834503   309622088  2036596854 -1399722575
##  [11] -1769090077  1644269746   758086916  -411328953  -933271267
##  [16]  -584751212  1754983226  1486583685  1250108511 -1930580250
##  [21]   983061872  1040424595  -645470415  -477078048 -1131935106
##  [26]  1357289737   992557883  -536112374   228571884  -458541201
##  [31] -1933412187  1667854940  -413826510 -1090475731  -505663513
##  [36]   743495438 -1301870360 -1865409813  1616720777  1514163992
##  [41]  2090840646   698184353 -1238960845   701369506 -1253842028
##  [46] -2131953129 -1080263155  2074336036 -1730918646  1234291317
##  [51]   485341647  1326777046 -1455659392   614099139  1615644257
##  [56] -1136845104  1963755566 -1590739495   683434475   609543258
##  [61] -1390977508  1681092383   126370677   630581772  1322478562
##  [66]  1280481469  1869219639  1580715998  1385331992 -2083860357
##  [71]  -785431015  -113086808   580197462   568834257   -71736189
##  [76]  -210696430   523379364  1470819943   221142973   367677748
##  [81]   303682202   892375269  1285263999  -793486330 -2046873712
##  [86] -1770761677  1570195921   441064320 -1075259810   546999721
##  [91]   304684123 -1475902358  -326566644  1369808719 -1461593083
##  [96]  -800144708 -1513679982    36917389   302769863 -1693847634
## [101]   649337352 -1192206837  -508864791 -1895910984  1605553766
## [106]  -995030271 -1800053357  -127044030  1896262132   555717623
## [111]  -284235795 -1042775932  1141135018   805374997 -2009350993
## [116]   683504310  -627560224 -1532265437    52003649  1285885488
## [121]  -629625778     7398585  1394827467  -357298822 -1414770564
## [126]  1796666559  1997570453  1294240172  1299422082  1114218845
## [131]  -808476585 -1406978242 -1890304136 -1442245541   373138361
## [136] -1921424888  1738967222  1367355377 -1491232221   350425714
## [141]   153618628 -1570890105   245618269   466516052   456231546
## [146] -1340902971  1448682271 -1272181082  1337958448 -1123581229
## [151]     6764785  -128695264  -625261890  1061496521 -1000676229
## [156]  -518792630   771579564  -716990033   368636261  1949441820
## [161]  1718698866  -112967699  1415295015 -1205704626 -1467429720
## [166]   911745707   439609289 -1578509352  -124704122  1532955489
## [171] -1883386125 -1718480542   129978324  1743542999  -238853939
## [176] -1874175900  -329599414 -1174633547  1127145231  -798761962
## [181]  -760830272  2145403011 -1402602335  -704392560 -1448865426
## [186] -1053552871  2127479723 -1018089062  2068563292 -1143505825
## [191] -1549401035 -1988444212   802454306  1945077117  1242154615
## [196]   822435742  1948401240   198219707 -1534576295  -880200984
## [201] -1456444650   974830737    12472643   666287186 -1193509148
## [206] -1373738713  -967652995  2086797428  -474684838 -1786990939
## [211]  1158388927     1040198 -1283580464    -4251661  -187332847
## [216]    96421696 -1986515170 -1884586007  1758909723  -848842966
## [221]  -438984628 -1192155121 -1359289531   929973500   -44690606
## [226]   581403853  -782326649   136519534  1699934536   944478546
## [231]  1190969056  1954771148 -2049705824 -1632913022   -23021336
## [236]   671840492   576993340 -1343487886 -2052265872  1931952676
## [241]  1218183736  -952890854   874606800   786069052  -416363372
## [246]   541676674  1766950848   418524476  -928964976  -651807710
## [251]  1141575688  -518185844 -1869512676   730694802  1213279360
## [256]  1967957012   624550696 -1550535622 -1478153008 -1229646740
## [261]   684799668 -1152663534  -946339872 -1588597812  1202855392
## [266]  1321356322  -308865752   800291084 -1662104004  -948452110
## [271] -1081468688   -66349244   136335448 -1234214342 -1896347408
## [276] -2062736708  -965752300  1202588866 -1402268064 -1829182084
## [281]  -425745200  1973621794  1976461480   475045260  1499398588
## [286]   299157554  -837463232 -1548575052 -1693445816   512856762
## [291] -2017534192  1641275628  -522766252  1955940114  -420331104
## [296]  1857595340   746823520  -575402814   642371112   708667820
## [301] -1976491204 -1795832974   111349552   549101604  -539795912
## [306]  2016031450  -681429104  1972524284 -1429475948   214401858
## [311]  1315572224 -1839839172  1005265488   245112994   -21765304
## [316]  -585123316  -983442724   194490450   158993536 -1922644140
## [321]  -138534936  -995249414     9480016 -1161247700 -1638299276
## [326]   708857490   376848992   710520972   931582304  -844957470
## [331]   945286312   339523276  1750661628 -1017812046  1443480560
## [336]  1379058116   -93913768  -186273414  2107716016  2122754492
## [341] -1443242412 -1876674110 -1044077792  -191032388  2112303184
## [346]   933632994  -981647512  -714361012 -1126830340  1779541746
## [351]  1414405376 -1682645900 -1127035384  1881810362 -1135155760
## [356]  1229580268  -856413292 -1085896494  1212331104 -1224118964
## [361]    18535200   713755266  1516851688   741104620 -1765257668
## [366]  -225819022 -1862849680  1167076644   336861752   558891418
## [371]  -583455280  1490699708  1144237716  1891840642   549891520
## [376]   595334972  1679688336  1572824866   598312456  -757046516
## [381]  -718302308  -519431150  1321610112  1097722644  1922626856
## [386]  1002995770 -1898892336  1893546604    53283892  1603825810
## [391]  2081773920  -806544052  -448449056  1314773922   153336744
## [396]  -153572212  -252746820 -1757260686  1519577072  1304491076
## [401] -1631885224 -1180004294   105605232  -357872068   824428308
## [406]   922315458   246387424  -445152132  -720327472   -79412318
## [411]   884440616 -1763733236    66090940   258703666  1913166016
## [416]   998863412  1417341640  -387984710   662117520   189118188
## [421] -1796966828  1561245330 -1432623328   215029708  -810489632
## [426]  -898343230   175985704 -2042168404 -1156097348   404562418
## [431]  -957008336 -1741989980   726831544  -456430758 -2130484080
## [436] -1082811524   525266708   284159298 -1968091392 -1704494148
## [441]  2134978384   -72208094  -868775352 -1296558068   604621916
## [446]  1601008082  1493513728 -1446039212   977662184 -2120732422
## [451] -1530546480 -1354733268  -518436620 -1270964846  -618436256
## [456]   614705164 -2007775495  1758565419  -576105572  -445772854
## [461]   390153407 -1347426807 -1593659618  1760450252   294237853
## [466]  -463338713 -1781322416  2082100206   766631067  1760376573
## [471] -2105295382  -140095864  -683247567   841466531 -2057041244
## [476] -1621861550  1771778727   321588977  2102517302  -191511852
## [481]  -485452187  1483097199 -1712963928  2086640646   808134963
## [486] -1472252523   831396338  1704810048  1246328745  -564430309
## [491]   701977580  1853469690 -1446952913  -380080071 -1308818866
## [496]  -347356516   439011341  -253766537   178095232   458019550
## [501]  2087485867  -396150099  1647746842  -228212776 -1266611135
## [506]  -630031629    42089748  -298252126 -1140832841     9492865
## [511] -1180442746  1253363140 -1318015755 -1000946337  1181214648
## [516]  -776090986 -1160219485 -1304441243  -815154302 -1155041040
## [521] -1093803879  -111921013  -233758340  1153982378  1518411743
## [526]  1512459625 -1593659010 -2071617172  2122783165   484002439
## [531]  -694612368 -1955375858 -1898825157 -2109800163  -513002550
## [536] -1522488088 -1818390575   242688451  1963526852  1846233458
## [541] -2099506105 -2135902191   733716886 -1738738444  -505217403
## [546]  1453938639  1197233864 -1146712218   573961619  1005684469
## [551]  1055008466 -1164873440  -761798391  1173440059  -236774516
## [556]  2020407834  1520323215  2116834777    -2409874    75213308
## [561]   688573293  1317115159  -482074400 -1825958210   194286731
## [566]  1824482061  -172571846 -1123075208  1906854177 -2121719341
## [571]  1564381428  1672065410  -303483881  -404282655   705797158
## [576]  -877557468 -1348728363  1836885375   466050072 -1526705354
## [581] -1782544957 -1328501755 -1285773406 -1741249648  1862084409
## [586]   662213611  1126130908   726154506   -81173505   770266697
## [591] -1934711842  -191513716  1810193245  -734319769  -269705072
## [596]   210452142  -927376549  -623662275  -951590486   671796808
## [601]  -579715471    61923299  -507737372  1921184274 -1059920409
## [606]   956789169   864098294 -1696404972  1748800805  1785431599
## [611] -2030984216  1955656902 -1666150029 -1758610987 -2053878350
## [616]  1306911616 -1135028375  1855896539    27697964  -227066566
## [621]  -250919953   590075513  1811190030  -918613796   459450189
## [626] -2093268892
```

```r


# Calculate MAE (mean absolute error)

```


Interpretation of cross-validation results:

# Bias-variance tradeoff in estimating error with k-fold cross validation
#- K large: lower bias (large training sets), higher variance (training sets similar)
#– K small: higher bias (small training sets), lower variance (training sets less similar)



```r
plot(cars)
```

![plot of chunk unnamed-chunk-2](figure/unnamed-chunk-2.png) 


